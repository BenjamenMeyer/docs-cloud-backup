<?xml version="1.0" encoding="utf-8"?>
<?rax-warinfo rcbu-v1.0-rcbu-devguide?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
   xmlns:html="http://www.w3.org/1999/xhtml" xmlns:wadl="http://wadl.dev.java.net/2009/02"
   xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:m="http://www.w3.org/the key 1998/Math/MathML" version="5.0" xml:id="rcbu-devguide">

   <?rax pdf.url="../../../rcbu-devguide-latest.pdf" status.bar.text="INTERNAL DRAFT" ?>
   <title>Rackspace Cloud Backup Developer Guide</title>
   <titleabbrev>Rackspace Cloud Backup Developer Guide</titleabbrev>
   <info>
      <copyright>
         <year>2015</year>
      </copyright>
      <releaseinfo>API v2.0</releaseinfo>
      <productname>Rackspace Cloud Backup</productname>
      <pubdate/>
      <legalnotice role="rs-api">
         <annotation>
            <remark>Copyright details are filled in by the template.</remark>
         </annotation>
      </legalnotice>
      <abstract>
         <para>This document is intended for software developers interested in developing
            applications using the Rackspace Cloud Backup Application Programming Interface
               (<abbrev>API</abbrev>). </para>
      </abstract>
      <revhistory>
         <revision>
            <date>2015-06-30</date>
            <revdescription>
               <para>Initial release of Cloud Backup v2.0.</para>
            </revdescription>
         </revision>
      </revhistory>
      <raxm:metadata xmlns:raxm="http://docs.rackspace.com/api/metadata">
         <raxm:displayname>API Developer Guide</raxm:displayname>
         <raxm:product version="v1.0">rcbu</raxm:product>
         <raxm:priority>20</raxm:priority>
      </raxm:metadata>
   </info>
   <!-- skip this OpenStack section, but leave it in the xml  -->
   <chapter xmlns:m="http://www.w3.org/1998/Math/MathML" xml:id="overview">
      <title>Overview</title>
      <para>Rackspace Cloud Backup is a file-based backup application that enables you to choose
         which files and folders to back up from your cloud server. You can choose to restore your
         whole system with all of its folders and files, or to restore individual files or folders
         from a given date, or to restore to an entirely different server. </para>
      <para>Interactions with Rackspace Cloud Backup occur programmatically via the Rackspace Cloud
         Backup API, as described in this guide. </para>
      <para>Following are some of the tasks you can perform using Rackspace Cloud Backup: <itemizedlist>
            <listitem>
               <para>Select the files and folders that you want to back up from your cloud
                  server.</para>
            </listitem>
            <listitem>
               <para>Run your backups manually or on a schedule that works for you.</para>
            </listitem>
            <listitem>
               <para>See the activity from all your backups, for both current and previous
                  backups.</para>
            </listitem>
            <listitem>
               <para>Use AES-256 encryption with a private encryption key known only to you.</para>
            </listitem>
            <listitem>
               <para>Restore individual files and folders from a particular date.</para>
            </listitem>
            <listitem>
               <para>Save space with incremental backups that save only the changed portions of
                  files.</para>
            </listitem>
            <listitem>
               <para>Create unlimited backups.</para>
            </listitem>
         </itemizedlist>
      </para>
      <para>Choose your backup endpoint based on the location of the server that you want to use for
         backup or for restore. For a list of endpoints, see <xref
            linkend="Service_Access_Endpoints-d1e753"/>.</para>
      <note>
         <para>Rackspace Cloud Backup does not take snapshots of your server. To read more about how
            Rackspace Cloud Backup differs from snapshots, see <link
               xlink:href="  http://www.rackspace.com/knowledge_center/article/rackspace-cloud-backup-vs-cloud-server-image-backups"
               > "Rackspace Cloud Backup vs. Cloud Server Image Backups"</link> in the Rackspace
            Knowledge Center. </para>
      </note>
      <section xml:id="Intended_Audience-d1e122">
         <title>Intended audience</title>
         <para> This guide is intended to assist software developers who want to develop
            applications by using the Rackspace Cloud Backup API. It assumes the reader has a
            general understanding of storage and is familiar with the following items: </para>
         <itemizedlist spacing="compact">
            <listitem>
               <para>RESTful web services</para>
            </listitem>
            <listitem>
               <para>HTTP/1.1 conventions</para>
            </listitem>
            <listitem>
               <para>JSON data serialization formats</para>
            </listitem>
         </itemizedlist>
      </section>
      <?hard-pagebreak?>
      <section xml:id="Document_Change_History-d1e166">
         <title>Document change history</title>
         <para>This version of this guide replaces and obsoletes all earlier versions. The most
            recent changes are described in the following table: </para>
         <?rax revhistory?>
      </section>
      <section xml:id="Additional_Resources-d1e532">
         <title>Additional resources</title>
         <para>For information about getting started using Cloud Backup using cURL, refer to the
               <citetitle>Cloud Backup Getting Started Guide</citetitle> at <link
               xlink:href="http://docs.rackspace.com/api/">docs.rackspace.com</link>. You can
            download the most current versions of the API-related documents from <link
               xlink:href="http://docs.rackspace.com/api/">docs.rackspace.com</link>. </para>
         <para>For more information about using the Cloud Backup API with cURL, see the blog post
               <link
               xlink:href="http://developer.rackspace.com/blog/rackspace-cloud-backup-api-with-curl.html#.UVmiv6tetLw"
               >Rackspace Cloud Backup API with cURL</link>.</para>
         <para>Additional information about Cloud Backup is also available in the Rackspace
            Knowledge Center at <link
               xlink:href="http://www.rackspace.com/knowledge_center/article/best-practices-for-cloud-backup"
               >Best Practices for Cloud Backup</link>.</para>
         <para>For information about Rackspace Cloud products, see <link
               xlink:href="http://www.rackspace.com/cloud/">www.rackspace.com/cloud</link>. This
            site also offers links to the official support channels for Rackspace, including
            knowledge base articles, forums, phone, chat, and email. </para>
         <para>You can follow Rackspace updates and announcements via twitter at: <link
               xlink:href="http://www.twitter.com/rackspace">www.twitter.com/rackspace</link>. </para>
         <para>This API uses standard HTTP 1.1 response codes as documented at: <link
               xlink:href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html"
               >www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</link>. </para>
      </section>
      <section xml:id="API_Contract_Changes-d1e363">
         <title>API contract changes</title>
         <para>Rackspace notifies customers in release notes when and if the contract
            changes.</para>
      </section>
      <section xml:id="Pricing-Service_Level">
         <title>Pricing and service level</title>
         <para>Cloud Backup is part of the Rackspace Cloud and your use of the Cloud Backup API will
            be billed according to the pricing schedule at <link
               xlink:href="http://www.rackspace.com/cloud/backup/pricing/"
               >http://www.rackspace.com/cloud/backup/pricing/</link>. Information about service
            level agreements (SLAs) is also available from that link.</para>
      </section>
      <section xml:id="Concepts">
         <title>Concepts</title>
         <?dbhtml stop-chunking?>
         <para>To use the Rackspace Cloud Backup API effectively, you should understand several key
            concepts:</para>
         <section xml:id="concept_Agent">
            <title>Agent</title>
            <para>An agent is an executable that sits on your cloud server that knows how to perform
               backups and restores. Agent installation currently supports Windows and Unix or Linux
               platforms. </para>
         </section>
         <section xml:id="concept_BackupConfig">
            <title>Backup configuration</title>
            <para>Backup configuration defines what needs to be backed up and when it needs to be
               backed up. The backup configuration includes a schedule for the backup, files to back
               up, and notifications.</para>
         </section>
         <section xml:id="concept_Restore">
            <title>Restore</title>
            <para>Restore is a process of bringing your system back to a previously saved state,
               usually by using a backup as the checkpoint. </para>
         </section>
         <section xml:id="concept_RestoreConfig">
            <title>Restore configuration</title>
            <para>A restore configuration defines what the restore checkpoint is and the where the
               backup should be restored. </para>
         </section>
         <section xml:id="Server-Set-Up-d1e001">
            <title>Server setup</title>
            <para>Because Cloud Backup is a file-level backup product, you must configure a separate
               backup for each cloud server and that a backup does not automatically apply to an
               entire environment. You must select the files and folders you want to back up from
               your cloud server. This setup requirement applies to Rackspace Cloud Servers,
               including the Performance Cloud Servers offering. </para>
         </section>
      </section>
   </chapter>
   <chapter xmlns:m="http://www.w3.org/1998/Math/MathML" xml:id="General_API_Information-d1e633">
      <title>General API information</title>
      <para>The Rackspace Cloud Backup API is implemented using a RESTful web service interface.
         Like other products in the Rackspace Cloud suite, Rackspace Cloud Backup shares a common
         token-based authentication system that allows seamless access between products and
         services. </para>
      <note>
         <para> All requests to authenticate against and operate the service are performed using SSL
            over HTTP (HTTPS) on TCP port 443. </para>
      </note>
      <section xml:id="Authentication-d1e647">
         <title>Authentication</title>
         <para> Every REST request against the Rackspace Cloud Backup Service requires the inclusion
            of a specific authorization token, supplied by the <code>X-Auth-Token</code> HTTP
            header. Customers obtain this token by first using the Rackspace Cloud Identity Service
            and supplying a valid user name and API access key. </para>
         <para>To authenticate, submit a <code>POST/v2.0/tokens</code> request, presenting valid
            Rackspace customer credentials in the message body to a Rackspace authentication
            endpoint. </para>
         <para>
            <emphasis role="bold">GET YOUR CREDENTIALS</emphasis>
         </para>
         <para>You can use either of two sets of credentials: <itemizedlist>
               <listitem>
                  <para>your user name and password </para>
               </listitem>
               <listitem>
                  <para>your user name and API key </para>
               </listitem>
            </itemizedlist>
         </para>
         <para>Your user name and password are the ones that you use to login to the Cloud Control
            Panel. After you are logged in, you can use the Cloud Control Panel to obtain your API
            key. </para>
         <para><emphasis role="bold">To find your API key:</emphasis>
         </para>
         <orderedlist>
            <listitem>
               <para>Log in to the Cloud Control Panel (<link
                     xlink:href="https://mycloud.rackspace.com"
                  >https://mycloud.rackspace.com</link>).</para>
            </listitem>
            <listitem>
               <para>On the upper-right side of the top navigation pane, click your username.</para>
            </listitem>
            <listitem>
               <para>From the menu, select <guilabel>Account Settings</guilabel>.</para>
            </listitem>
            <listitem>
               <para>In the Login Details section of the Account Settings page, locate the
                     <guilabel>API Key</guilabel> field and click
                  <guibutton>Show</guibutton>.</para>
            </listitem>
            <listitem>
               <para>Copy the value of the API key and paste it into a text editor of your
                  choice.</para>
            </listitem>
            <listitem>
               <para>Click <guibutton>Hide</guibutton> to hide the value of the API key.</para>
            </listitem>
         </orderedlist>
         <para>You also need your cloud account number. In the documentation, the account number is
            often referred to as your tenant name or tenant ID (technically, the ID is different
            from the name, but at Rackspace, they are the same thing). Together, three
            components—your user name, your API key, and your tenant ID or cloud account number—form
            the authentication credentials that are required to connect to the Rackspace
            cloud.</para>
         <para>To find your tenant ID or cloud account number, locate your user name on the
            upper-right side of the top navigation pane in the Cloud Control Panel. The tenant ID or
            account number is in parentheses just to the right of your user name.</para>
         <para>
            <emphasis role="bold">USE YOUR AUTHENTICATION ENDPOINT</emphasis>
         </para>
         <para>Use the following endpoint to access the Cloud Identity Service, regardless of US or
            UK identities: <itemizedlist spacing="compact">
               <listitem>
                  <para><link xlink:href=" https://identity.api.rackspacecloud.com/v2.0/">
                        https://identity.api.rackspacecloud.com/v2.0/</link></para>
               </listitem>
            </itemizedlist>
         </para>
         <para>
            <emphasis role="bold">SEND YOUR CREDENTIALS TO YOUR AUTHENTICATION ENDPOINT</emphasis>
         </para>
         <para>If you know your credentials and your authentication endpoint, and you can issue a
               <code>POST /v2.0/tokens</code> request in an API call, you have all the basic
            information that you need to use the Rackspace Cloud Identity Service. </para>
         <para>You can use <link xlink:href="http://curl.haxx.se/">cURL</link> to try the
            authentication process in two steps: 1) get a token; 2) send the token to a service.<orderedlist>
               <listitem>
                  <para>Get an authentication token by providing your user name and either your API
                     key or your password. Following are examples of both approaches:</para>
                  <itemizedlist>
                     <listitem>
                        <para>You can request a token by providing your user name and your API
                           key.</para>
                        <para>
                           <literallayout class="monospaced">curl -X POST https://auth.api.rackspacecloud.com/v2.0/tokens -d 
'{ "auth":{ "RAX-KSKEY:apiKeyCredentials":{ "username":"<emphasis role="bold">yourUserName</emphasis>", "apiKey":"<emphasis role="bold">yourApiKey</emphasis>" } } }' -H "Content-type: application/json"</literallayout>
                        </para>
                     </listitem>
                     <listitem>
                        <para>You can request a token by providing your user name and your
                           password.</para>
                        <para>
                           <literallayout class="monospaced">curl -X POST https://auth.api.rackspacecloud.com/v2.0/tokens -d
'{"auth":{"passwordCredentials":{"username":"<emphasis role="bold">yourUserName</emphasis>","password":"<emphasis role="bold">yourPassword</emphasis>"}}}' -H "Content-type: application/json"</literallayout>
                        </para>
                     </listitem>
                  </itemizedlist>
                  <para>Successful authentication returns a token that you can use as evidence that
                     your identity has already been authenticated. To use the token, pass it to
                     other services as in the <code>X-Auth-Token</code> header. </para>
                  <para>Authentication also returns a service catalog, listing the endpoints you can
                     use for Cloud services. </para>
               </listitem>
               <listitem>
                  <para>Use the authentication token to send a <command>GET</command> to a service
                     you would like to use. Here is an example of passing an authentication token to
                     the Cloud Files service, using the Cloud Files service catalog endpoint that
                     was returned along with the token.</para>
                  <para>
                     <literallayout class="monospaced">curl -X GET https://storage101.dfw1.clouddrive.com/v1/MossoCloudFS_aaaaaaaa-bbbb-cccc-dddd-eeeeeeee
-H 'X-Auth-Token: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' --verbose</literallayout>
                  </para>
               </listitem>
            </orderedlist>
         </para>
         <tip>
            <para> For links to language binding examples you can adapt to work with the Cloud
               Identity service, visit <link
                  xlink:href="http://docs.rackspace.com/sdks/guide/content/index.html">
                  docs.rackspace.com/sdks/guide/content/index.html</link>.</para>
         </tip>
         <para>Authentication tokens are typically valid for 24 hours. Applications should be
            designed to re-authenticate after receiving a 401 (Unauthorized) response from a service
            endpoint. </para>
         <important>
            <para>If you are programmatically parsing an authentication response, be aware that
               service names are stable for the life of the particular service and can be used as
               keys. You should also be aware that a user's service catalog can include multiple
               uniquely-named services that perform similar functions. For example,
               cloudServersOpenStack is the OpenStack version of compute whereas cloudServers is the
               legacy version of compute. The same user can have access to both services. In the
               Cloud Identity Service v2.0, the service type attribute can be used as a key to
               recognize similar services. See the following tip.</para>
         </important>
         <tip>
            <para>Beginning with Rackspace Cloud Identity Service v2.0 (earlier versions were called
               Rackspace Cloud Authentication Service), the service catalog includes a service type
               attribute to identify services that perform similar functions but have different
               names; for example, <code>type="compute"</code> identifies compute services such as
               cloudServers and cloudServersOpenStack. Some developers have found the service type
               attribute to be useful in parsing the service catalog. For Cloud Identity Service
               v2.0 , you can see the service type attribute in the "Service Catalog in
               Authentication Response" samples in the <citetitle>Cloud Identity Client Developer
                  Guide</citetitle> at <link
                  xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/Sample_Request_Response-d1e64.html"
                  >http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/Sample_Request_Response-d1e64.html</link>.</para>
         </tip>
      </section>
      <section xml:id="RBAC-d1e001">
         <title>Role Based Access Control</title>
         <para>Role Based Access Control (RBAC) restricts access to the capabilities of Rackspace
            Cloud services, including the Cloud Backup API, to authorized users only. RBAC enables
            Rackspace Cloud customers to specify which account users of their Cloud account have
            access to which Cloud Backup API service capabilities, based on roles defined by
            Rackspace (see <xref linkend="RBAC_product_roles_table"/>). The permissions to perform
            certain operations in Cloud Backup API – create, read, update, delete – are assigned to
            specific roles, and these roles can be assigned by the Cloud account admin user to
            account users of the account. </para>
         <section xml:id="RBAC-Assigning_Roles-d1e001">
            <title>Assigning roles to account users</title>
            <para>The account owner (identity:user-admin) can create account users on the account
               and then assign roles to those users. The roles grant the account users specific
               permissions for accessing the capabilities of the Cloud Backup service. Each account
               has only one account owner, and that role is assigned by default to any Rackspace
               Cloud account when the account is created.</para>
            <para>See the <citetitle>Cloud Identity Client Developer Guide</citetitle> for
               information about how to perform the following tasks:</para>
            <itemizedlist spacing="compact">
               <listitem>
                  <para><link
                     xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/POST_addUser__v2.0_users_User_Calls.html"
                     >Create account users</link></para>
               </listitem>
               <listitem>
                  <para><link
                     xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/PUT_addUserRole__v2.0_users__userId__roles_OS-KSADM__roleid__Role_Calls.html"
                     >Assign roles to account users</link></para>
               </listitem>
               <listitem>
                  <para><link
                     xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/DELETE_deleteUserRole__v2.0_users__userId__roles_OS-KSADM__roleid__Role_Calls.html"                            
                     >Delete roles from account users</link></para>
               </listitem>
            </itemizedlist>
            <note>
               <para>The account owner (identity:user-admin) role cannot hold any additional roles
                  because it already has full access to all capabilities.</para>
            </note>
         </section>
         <section xml:id="RBAC-Roles-Available-d1e001">
            <title>Roles available for Cloud Backup </title>
            <para>Three roles (admin, creator, and observer) can be used to access the Cloud Backup
               API specifically. The following table describes these roles and their
               permissions.</para>
            <table xml:id="RBAC_product_roles_table" rules="all">
               <caption>Cloud Backup product roles and permissions</caption>
               <col width="50%"/>
               <col width="50%"/>
               <thead>
                  <tr>
                     <th>Role name</th>
                     <th>Role permissions</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>cloudBackup:admin</td>
                     <td>This role provides Create, Read, Update, and Delete permissions in Cloud
                        Backup, where access is granted.</td>
                  </tr>
                  <tr>
                     <td>cloudBackup:creator</td>
                     <td>This role provides Create, Read, and Update permissions in Cloud Backup,
                        where access is granted.</td>
                  </tr>
                  <tr>
                     <td>cloudBackup:observer</td>
                     <td>This role provides Read permission in Cloud Backup, where access is
                        granted.</td>
                  </tr>
               </tbody>
            </table>
            <para>Additionally, two multiproduct roles apply to all products. Users with
               multiproduct roles inherit access to future products when those products become
               RBAC-enabled. The following table describes these roles and their permissions.</para>
            <table xml:id="RBAC_global_roles_table" rules="all">
               <caption>Multiproduct (Global) roles and permissions</caption>
               <col width="50%"/>
               <col width="50%"/>
               <thead>
                  <tr>
                     <th>Role name</th>
                     <th>Role permissions</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>admin</td>
                     <td>This role provides Create, Read, Update, and Delete permissions in all
                        products, where access is granted.</td>
                  </tr>
                  <tr>
                     <td>observer</td>
                     <td>This role provides Read permission in all products, where access is
                        granted.</td>
                  </tr>
               </tbody>
            </table>
         </section>
         <section xml:id="RBAC-Resolving-Conflicts-d1e001" version="5.0">
            <title>Resolving conflicts between RBAC multiproduct vs. custom (product-specific)
               roles</title>
            <para>The account owner can set roles for both multiproduct and Cloud Backup scope, and
               it is important to understand how any potential conflicts among these roles are
               resolved. When two roles appear to conflict, the role that provides the more
               extensive permissions takes precedence. Therefore, admin roles take precedence over
               observer and creator roles, because admin roles provide more permissions. </para>
            <para>The following table shows two examples of how potential conflicts between user
               roles in the Control Panel are resolved: </para>
            <para>
               <informaltable rules="all">
                  <thead>
                     <tr align="center">
                        <td>Permission configuration</td>
                        <td>View of permission in the Control Panel </td>
                        <td>Can the user perform product admin functions in the Control Panel?</td>
                     </tr>
                  </thead>
                  <tbody>
                     <tr>
                        <td>User is assigned the following roles: multiproduct <emphasis role="bold"
                              >observer</emphasis> and Cloud Backup <emphasis role="bold"
                              >admin</emphasis></td>
                        <td>Appears that the user has only the multiproduct <emphasis role="bold"
                              >observer</emphasis> role</td>
                        <td>Yes, for Cloud Backup only. The user has the <emphasis role="bold"
                              >observer</emphasis> role for the rest of the products.</td>
                     </tr>
                     <tr>
                        <td>User is assigned the following roles: multiproduct <emphasis role="bold"
                              >admin</emphasis> and Cloud Backup <emphasis role="bold"
                              >observer</emphasis></td>
                        <td>Appears that the user has only the multiproduct <emphasis role="bold"
                              >admin</emphasis> role</td>
                        <td>Yes, for all of the products. The Cloud Backup <emphasis role="bold"
                              >observer</emphasis> role is ignored.</td>
                     </tr>
                  </tbody>
               </informaltable>
            </para>
         </section>
         <section xml:id="RBAC-Permissions-d1d001" version="5.0">
            <title>RBAC permissions cross-reference to Cloud Backup API operations</title>
            <para>API operations for Cloud Backup may or may not be available to all roles. To see
               which operations are permitted to invoke which calls, please review <link
                  xlink:href="http://www.rackspace.com/knowledge_center/article/permissions-matrix-for-role-based-access-control-rbac"
                  >the Knowledge Center article</link>.</para>
         </section>
      </section>
      <section xml:id="Service_Access_Endpoints-d1e753">
         <title>Service access endpoints</title>
         <para>The Rackspace Cloud Backup Service is a regionalized service. The user of the service
            is therefore responsible for appropriate replication, caching, and overall maintenance
            of Rackspace Cloud Backup data across regional boundaries to other Rackspace Cloud
            Backup servers.</para>
         <para>You can find the available service endpoints for Rackspace Cloud Backup in the
            following table. </para>

            <para>To help you decide which regionalized endpoint to use, read the Knowledge Center article about special
               considerations for choosing a data center at <link
                  xlink:href="http://www.rackspace.com/knowledge_center/article/about-regions"
                  >About Regions</link>.
            </para>
          
         <?rax-fo keep-with-next?>
         <para>
            <table rules="all">
               <caption>Regionalized service endpoints</caption>
               <col width="27%"/>
               <col width="73%"/>
               <thead>
                  <tr>
                     <th>Region</th>
                     <th>Endpoint</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>Dallas/Ft. Worth (DFW)</td>
                     <td><code>https://dfw.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code>
                     </td>
                  </tr>
                  <tr>
                     <td>Chicago (ORD)</td>
                     <td><code>https://ord.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code></td>
                  </tr>
                  <tr>
                     <td>London (LON) </td>
                     <td><code>https://lon.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code></td>
                  </tr>
                  <tr>
                     <td>Hong Kong (HKG)</td>
                     <td><code>https://hkg.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code></td>
                  </tr>
                  <tr>
                     <td>Northern Virginia (IAD)</td>
                     <td><code>https://iad.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code></td>
                  </tr>
                  <tr>
                     <td>Sydney (SYD)</td>
                     <td><code>https://syd.backup.api.rackspacecloud.com/v2.0/<parameter>1234</parameter>/</code></td>
                  </tr>
               </tbody>
            </table>
         </para>
         <para>Every REST requires a project ID (which is also referred to as the account ID or
            tenant ID) in the service access endpoint or in the <code>X-Project-Id</code> header. </para>
         <para>In the endpoints in the table above, replace the example project ID,
               <parameter>1234</parameter>, with your actual project ID that is returned in the
            service catalog as part of the Cloud Identity service response. </para>
         <para>You will find the actual project ID after the final '/' in the <code>publicURL</code>
            field returned by the authentication response.</para>
         <note>
            <para>The examples in this guide include the project ID in the request URIs.</para>
         </note>
      </section>
      <section xml:id="DB_service_versions">
         <title>Rackspace Cloud Backup service versions</title>
         <para>The Rackspace Cloud Backup version defines the contract and build information for the
            API. </para>
         <section xml:id="contractVersion">
            <title>Contract version</title>
            <para>The contract version denotes the data model and behavior that the API supports.
               The contract version is included in all request URIs. Different contract versions of
               the API might be available at any given time and are not guaranteed to be compatible
               with one another. </para>
            <example>
               <title>Example request URI (contract version in bold)</title>
               <programlisting>
https://dfw.backup.api.rackspacecloud.com/<emphasis role="bold">v2.0</emphasis>/1234/
  </programlisting>
            </example>
         </section>
         <section xml:id="apiVersion">
            <title>List API version</title>
            <para>You can list which API versions are available for your account by using the list
               versions request.</para>
            <para>Issue a <command>GET</command> request to the root endpoint for a service. In the
               request, truncate the version and everything to the right of it. For example: </para>
            <example>
               <title>Example list versions request </title>
               <programlisting>
    GET HTTP/1.1
    Host: https://dfw.backup.api.rackspacecloud.com/
  </programlisting>
            </example>
            <para>This operation does not require a request body. </para>
            <para>Normal Response Codes: 200, 203 </para>
            <para>Error Response Codes: 400, 413, 500, 503 </para>
         </section>
         <section xml:id="Request_Response_Types-d1e903">
            <title>Request and response types</title>
            <para>The Rackspace Cloud Backup API supports only JSON data serialization format. </para>
            <para>All responses with a message body have a <code>Content-Type</code> header defined
               as <code>application/json</code>.</para>
            <para>Most requests with a message body also require a <code>Content-Type</code> of
                  <code>application/json</code>. <command>PATCH</command> requests require a
                  <code>Content-Type</code> of <code>application/json-patch+json</code>.</para>
         </section>
         <section xml:id="DB_faults">
            <title>Common HTTP response codes</title>
            <para>When an error occurs, the Rackspace Cloud Backup Service returns a fault object
               containing an HTTP error response code that denotes the type of error. In the body of
               the response, the system returns additional information about the fault. </para>
            <para>The following table lists possible fault types with their associated error codes
               and descriptions. </para>
            <informaltable rules="all">
               <thead>
                  <tr align="center">
                     <td colspan="2">Response code</td>
                     <td colspan="1">Type</td>
                     <td colspan="3">Description</td>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td colspan="2"><code>200</code>
                     </td>
                     <td colspan="1">OK</td>
                     <td colspan="3">The request succeeded. Some successful requests might return
                        more specific 200-class codes.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>201</code></td>
                     <td colspan="1">Created</td>
                     <td colspan="3">The request was fulfilled and has resulted in one or more new
                        resources being created.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>202</code></td>
                     <td colspan="1">Accepted</td>
                     <td colspan="3">The request was accepted for processing, but the processing has
                        not completed.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>204</code></td>
                     <td colspan="1">No Content</td>
                     <td colspan="3">The server successfully fulfilled the request, and there is no
                        additional content to send in the response body.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>400</code></td>
                     <td colspan="1">Bad Request</td>
                     <td colspan="3">The server cannot or will not process the request due to
                        something that is perceived as a client error (for example, malformed
                        syntax, invalid request framing, or deceptive request routing).</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>401</code>
                     </td>
                     <td colspan="1">Unauthorized</td>
                     <td colspan="3">The request has not been applied because it lacks valid
                        authentication credentials for the target resource. The credentials are
                        either expired or invalid.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>403</code>
                     </td>
                     <td colspan="1">Forbidden</td>
                     <td colspan="3">The server understood the request but refuses to authorize
                        it.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>404</code>
                     </td>
                     <td colspan="1">Not Found</td>
                     <td colspan="3">The server did not find a current representation for the target
                        resource or is not willing to disclose that one exists. </td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>405</code></td>
                     <td colspan="1">Method Not Allowed</td>
                     <td colspan="3">The method received in the request line is known by the origin
                        server but is not supported by the target resource.</td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>500</code>
                     </td>
                     <td colspan="1">Internal Server Error</td>
                     <td colspan="3">The server encountered an unexpected condition that prevented
                        it from fulfilling the request. </td>
                  </tr>
                  <tr>
                     <td colspan="2"><code>503</code>
                     </td>
                     <td colspan="1">Service Unavailable</td>
                     <td colspan="3">The server is currently unable to handle the request due to a
                        temporary overload or scheduled maintenance, which will likely be alleviated
                        after some delay.</td>
                  </tr>
               </tbody>
            </informaltable>
            <para>When possible, error responses include a response body that details the error. A
               typical example response follows:  </para>
            <programlisting>{
   "message": "Validation failed.",     
   "errors": [         
      "Name is required.",         
      "RSA public key is required."     
   ] 
} </programlisting>
            <para>The symptoms and solutions for some frequently encountered issues follow. </para>
            <para>
               <itemizedlist>
                  <title>Backups get corrupted</title>
                  <listitem>
                     <para>Does your server have a backup agent and did you clone it to create a new
                        backup system? This means that two backup agents exist with the same
                        credentials writing to the same vault. </para>
                  </listitem>
                  <listitem>
                     <para><emphasis>Solution:</emphasis> Ensure the agent on the cloned backup
                        server is re-registered before any backups are run. </para>
                  </listitem>
               </itemizedlist>
               <itemizedlist>
                  <title>Backups get network error</title>
                  <listitem>
                     <para><emphasis>Solution:</emphasis> Make sure that your backup server has a
                        connection to both service net and public net. If it is on an isolated
                        network, the backup agent is able to function properly. </para>
                  </listitem>
               </itemizedlist>
               <itemizedlist>
                  <title>Backups sometimes fail</title>
                  <listitem>
                     <para>This is most commonly caused by either a failure to communicate with
                        Cloud Files, running out of disk space, or a failure to communicate with
                        Cloud Backup. </para>
                     <para>Sometimes the agent might fail to backup a particular file because of a
                        permissions error. Either the file is in use when the agent attempts to save
                        it or the file in question cannot be read by the agent. Consider permissions
                        when hunting for the root cause of a backup failure. </para>
                  </listitem>
                  <listitem>
                     <para><emphasis>Solution:</emphasis> Make sure that you're running the latest
                        agent release. After that, attempt to determine the cause of the error, and
                        try the backup or restore again if it is an intermittent error. </para>
                  </listitem>
               </itemizedlist>
               <itemizedlist>
                  <title>Backup or Restore is slow</title>
                  <listitem>
                     <para>If your backup or restore is encrypted, it can be especially slow.
                        Encryption comes at a cost. </para>
                     <para>If your system uses Cloud Block Storage as the storage medium, this is
                        known to introduce some slowdowns. Consider whether the benefits of using
                        Cloud Block Storage outweigh the need for faster backups/restores. </para>
                  </listitem>
                  <listitem>
                     <para><emphasis>Solution:</emphasis> Make sure that you're running the latest
                        agent release. After that, attempt to determine the cause of the error, and
                        try the backup or restore again if it is an intermittent error. We're always
                        working on making backup more robust. </para>
                  </listitem>
               </itemizedlist>
            </para>
         </section>
      </section>
      <section  xml:id="agentHeader">
         <title>Agent header</title>
         <para>Agents communicating with Cloud Backup should always send an <code>X-Agent-Id</code>
            header in the request.</para>
      </section>
   </chapter>
   <chapter xml:id="operations" xmlns="http://docbook.org/ns/docbook" role="api-reference">
      <title>API operations</title>
      <para>This chapter describes each of the Cloud Backup API operations, which are summarized in
         the following table.</para>
      <section xml:id="Health-operations" >
         <title>Health check operations</title>
         <para>This section describes the health checking operations for the Cloud Backup
            API.</para>
            <wadl:resources xmlns:wadl="http://wadl.dev.java.net/2009/02">
               <wadl:resource href="../../src/wadl/rcbu-v2.wadl#health">
                  <wadl:method href="#getHealthCheck"/>
               </wadl:resource>
               <wadl:resource href="../../src/wadl/rcbu-v2.wadl#dependent_system">
                  <wadl:method href="#getHealthDetails"/>
               </wadl:resource>
               <wadl:resource href="../../src/wadl/rcbu-v2.wadl#ping">
                  <wadl:method href="#getPing"/>
               </wadl:resource>
            </wadl:resources>
      </section>
     <section xml:id="Activity-operations">
         <title>Activity operations</title>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the activity
            operation that is supported by the Cloud Backup API. </para>
         <wadl:resources>
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#activities">
               <wadl:method href="#getProjectActivities"/>
            </wadl:resource>
         </wadl:resources>
         <?hard-pagebreak?>
      </section>
      <section xml:id="Agents-operations">
         <title>Agents operations</title>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the agents
            operations that are supported by the Cloud Backup API. </para>
         <wadl:resources>
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#agents">
               <wadl:method href="#postAgent"/>
               <wadl:method href="#getProjectAgents"/>
            </wadl:resource>
            
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#agent_id">
               <wadl:method href="#updateAgent"/>               
            </wadl:resource>
         </wadl:resources>
         <?hard-pagebreak?>
      </section>
<!--      
      <section xml:id="Backup-Operations">
         <title>Backup operations</title>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the backup
            operations that are supported by the Cloud Backup API. </para>
         <wadl:resources>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-action-requested">
               <wadl:method href="startStopBackupManually"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup__backupId">
               <wadl:method href="getBackupDetails"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#completedBackupConfigurationId">
               <wadl:method href="getCompletedBackups"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup_report_backupId">
               <wadl:method href="getBackupReport"/>
            </wadl:resource>
         </wadl:resources>
         <?hard-pagebreak?>
      </section>
      <section xml:id="Cleanup-Operations">
         <title>Cleanup operations</title>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the backup
            operations that are supported by the Cloud Backup API. </para>
         <wadl:resources>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-action-requested">
               <wadl:method href="startStopBackupManually"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup__backupId">
               <wadl:method href="getBackupDetails"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#completedBackupConfigurationId">
               <wadl:method href="getCompletedBackups"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup_report_backupId">
               <wadl:method href="getBackupReport"/>
            </wadl:resource>
         </wadl:resources>
         <?hard-pagebreak?>
      </section>
      <section xml:id="Configuration-Operations">
         <title>Configuration operations</title>
         <para>When trying to determine how often to back up a file in your backup configuration,
            there are three variables to consider: <orderedlist>
               <listitem>
                  <para>How important is tracking changes in the file to your business processes?
                     (criticality) </para>
               </listitem>
               <listitem>
                  <para>How large is the file? (size)</para>
               </listitem>
               <listitem>
                  <para>How often does the file change? (data churn)</para>
               </listitem>
            </orderedlist>Criticality is the most important factor to consider when making backup
            decisions. The more critical the file is to your business operations, the more often
            you'll want to back this file up. Size is an important consideration if the speed of
            backups/restores is important to you. Large files take longer to backup and to restore.
            It might be wise to backup large files less frequently. Data churn is the last variable
            to consider, and perhaps the trickiest to handle. Files that change often invalidate
            blocks that have been stored previously. Depending on criticality, it might still be
            wise to snapshot files with high data churn and backup those snapshots. </para>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the backup
            configuration operations that are supported by the Cloud Backup API. </para>
         <wadl:resources xmlns:wadl="http://wadl.dev.java.net/2009/02">
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-configuration">
               <wadl:method href="createBackupConfiguration"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-configuration-Id">
               <wadl:method href="updateBackupConfig"/>
               <wadl:method href="getBackupConfig"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-configuration">
               <wadl:method href="getAllBackupConfigforUser"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#machineAgentId">
               <wadl:method href="getAllBackupConfigforAgent"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backupConfigurationId">
               <wadl:method href="enableBackupConfig"/>
            </wadl:resource>
            <wadl:resource href="../../src/wadl/rcbu.wadl#backup-configuration-Id">
               <wadl:method href="deleteBackupConfig"/>
            </wadl:resource>
         </wadl:resources>
         <?hard-pagebreak?>
      </section>
-->      
      <section xml:id="Events-operations">
         <title>Events operations</title>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the events
            operations for the Cloud Backup API. </para>
         <wadl:resources xmlns:wadl="http://wadl.dev.java.net/2009/02">
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#events">
               <wadl:method href="postEvents"/>
               <wadl:method href="getEvents"/>            
            </wadl:resource>            
         </wadl:resources>            
         <?hard-pagebreak?>
      </section>
      
      <section xml:id="Restore-operations">
         <title>Restore operations</title>
         <para>You should periodically test your restores to make sure that they are working as you
            expect. The worst possible scenario is to need your data restored now, and then to
            discover that your data is not available because your backups have not been configured
            as you expected. </para>
         <para>Another point to consider is the restore destination. Restoring to the original
            location and overwriting saves the most storage space, but comes with the risk that you
            might accidentally overwrite important, existing files. Proceed with caution when
            restoring. </para>
         <para xmlns:m="http://www.w3.org/1998/Math/MathML">This section describes the restore
            operations that are supported by the Cloud Backup API. </para>

         <wadl:resources xmlns:wadl="http://wadl.dev.java.net/2009/02">
            
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#restores">
               <wadl:method href="postRestores"/>
               <wadl:method href="getRestores"/>
            </wadl:resource> 
            
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#restore_id">
                  <wadl:method href="#getRestoreDetails"/>
                  <wadl:method href="#updateRestore"/>               
            </wadl:resource>
            
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#errors">
               <wadl:method href="#getRestoreErrors"/>
            </wadl:resource>
            
            <wadl:resource href="../../src/wadl/rcbu-v2.wadl#event">
               <wadl:method href="#getRestoreEvents"/>
            </wadl:resource>
            
         </wadl:resources>                 
         <?hard-pagebreak?>
      </section>
   </chapter>
   <glossary xml:id="glossary_1">
      <title>Glossary</title>
      <glossentry xml:id="claim-d1e017">
         <glossterm>Agent</glossterm>
         <glossdef>
            <para>The application that is installed on the server that knows how to perform backups
               and restores.</para>
         </glossdef>
      </glossentry>
      <glossentry>
         <glossterm>Backup</glossterm>
         <glossdef>
            <para>A group of folders,  files, or both stored on Cloud Backup for a particular server
               and configuration.</para>
         </glossdef>
      </glossentry>
      <glossentry>
         <glossterm>Backup configuration</glossterm>
         <glossdef>
            <para>The definition of what is going to be backed up and when.</para>
         </glossdef>
      </glossentry>
      <glossentry xml:id="message-d1e016">
         <glossterm>Restore</glossterm>
         <glossdef>
            <para>The process of bringing your system back to a previously saved state.</para>
         </glossdef>
      </glossentry>
      <glossentry>
         <glossterm>Restore configuration</glossterm>
         <glossdef>
            <para>The definition of what is going to be restored and where.</para>
         </glossdef>
      </glossentry>
   </glossary>
</book>
